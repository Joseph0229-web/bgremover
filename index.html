 <!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>ç´”æœ¬åœ° AI å»èƒŒ (éš±ç§ä¿è­·ç‰ˆ)</title>
    <script src="coi-serviceworker.js"></script>
    <script type="module">
        import { pipeline, env } from 'https://cdn.jsdelivr.net/npm/@xenova/transformers@2.17.1';
        
        // æ ¸å¿ƒè¨­å®šï¼šç¦æ­¢ä»»ä½•å¤–éƒ¨ API å‚³è¼¸ï¼Œå¼·åˆ¶æœ¬åœ°åŒ–
        env.allowLocalModels = false; 
        // ä½¿ç”¨ CDN ä½†é€éç€è¦½å™¨å¿«å–
        
        window.startRemover = async function(file) {
            const status = document.getElementById('status');
            status.innerText = "æ­£åœ¨æœ¬åœ°è™•ç†ï¼Œè«‹ç¨å€™...";
            
            try {
                const segmenter = await pipeline('image-segmentation', 'Xenova/rmbg-1.4');
                const url = URL.createObjectURL(file);
                const output = await segmenter(url);
                
                const canvas = document.createElement('canvas');
                canvas.width = output.width; canvas.height = output.height;
                const ctx = canvas.getContext('2d');
                ctx.putImageData(output.toImageData(), 0, 0);
                
                document.getElementById('result').src = canvas.toDataURL();
                document.getElementById('result').style.display = 'block';
                status.innerText = "âœ… è™•ç†å®Œæˆ (100% æœ¬åœ°é‹ç®—)";
            } catch (e) {
                status.innerText = "âŒ ç€è¦½å™¨å®‰å…¨é™åˆ¶ï¼Œè«‹å˜—è©¦ä½¿ç”¨ Chrome ä¸¦é‡æ–°æ•´ç†ã€‚";
                console.error(e);
            }
        }
    </script>
    <style>
        body { font-family: sans-serif; text-align: center; padding: 50px; background: #f9f9f9; }
        .box { border: 2px dashed #ccc; padding: 30px; background: white; border-radius: 10px; }
        #result { max-width: 100%; margin-top: 20px; background: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAMUlEQVQ4T2NkYGAQYcAP3bgIEP9fG0YBAxrGZDJIDhg14Ghg1IDhgFEA9jzIDhh14IEBABy8AgOXy+/GAAAAAElFTkSuQmCC'); }
    </style>
</head>
<body>
    <div class="box">
        <h2>ğŸ”’ ç§å¯† AI å»èƒŒ</h2>
        <p>ä¿è­‰åœ–ç‰‡ä¸é›¢é–‹æ‚¨çš„é›»è…¦</p>
        <input type="file" onchange="startRemover(this.files[0])">
        <div id="status"></div>
        <img id="result" style="display:none;">
    </div>
</body>
</html>
